<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Check For Updates</title>
<meta http-equiv="Content-Type" content="text/html">
<script src="avlupdates.js"></script>
<script src="lang/resource.js"></script>
<link id="uistyles" href="UpdaterStyle.css" rel="stylesheet" type="text/css"/>
<script>
var twdl = unescape(top.window.document.location);
var twdls = twdl.substr(twdl.indexOf("?"));
var attribs = twdls.split("&");
var _CustomCSS="";
var _CustomStrings="";
for (ii = 0; ii < attribs.length; ii++)
{
	var attrib = attribs[ii].split("=");
	if (attrib[0].indexOf("CSS") != -1)
		_CustomCSS = attrib[1];
	if (attrib[0].indexOf("Strings") != -1)
		_CustomStrings = attrib[1];
}
if (_CustomCSS.length > 0)
	document.getElementById("uistyles").href=_CustomCSS;
</script>
</head>
<body topmargin="0" bottommargin="0" leftmargin="0" rightmargin="0" scroll="no" onload="pageload()">
<!-- TOP NAVIGATION AND LOGO -->
<div id="mainNavHeader">
	<div id="mainNavLogo"></div>
	<div id="mainNavIconSettings">
		<div class="theNav">
		<a href="settings.htm"><img src="images/icon_settings.gif" width="32" height="32" border="0"></a><br>
		<a href="settings.htm" id="ids_settings">Settings</a>
		</div>
	</div>
	<div id="mainNavIconAbout">
		<div class="theNav">
		<a href="about.htm"><img src="images/icon_about.gif" width="32" height="32" border="0"></a><br>
		<a href="about.htm" id="ids_about">About</a>
		</div>
	</div>
</div>

<!-- SECONDARY NAVIGATION -->
<div id="secNavHeader">
</div>

<div id="mainContent">

<!-- MAIN PANEL -->
	<div id="mainPanel">
		<div class="contentHeader" id="ids_new_updates">New updates & messages</div>
		<p></p>
			
			<table cellpadding="0" cellspacing="0" border="0" width="700">
			<tr align="left">
			<td valign="middle" bgcolor="ffffff">
					<table cellpadding="0" cellspacing="0" border="0" width="100%">
					<tr align="left">
					<td>
					<div id="ids_click_msg">Click Check for updates to view your program updates and messages.  </div>
					<p></p>   
					<div id="ids_programs">Program(s) </div> <select name="selectproduct" id="selectproduct">
					<option value="_All">All</option>
					</select>&nbsp;<!--input name="checkauto" id="checkauto" type="checkbox"> Check for updates automatically next time <br-->
					</td>
					</tr>
					</table>
			<div class="shortSpacerVert"></div>
			<input type="button" name="checkbtn" id="checkbtn" value="Check for Updates" onclick="docheck()">
			</td>
			</tr>
			</table>
			
			
		</div>
	</div>
</div>
<div id="bottom">
	<table cellpadding=0 cellspacing=0>
	<tr>
	<td>
	<div id="copyright"><span id="ids_copyright">Copyright (c) 1997-2011 Flexera Software LLC.  All Rights Reserved.</span>| <a id="Aterms" href="http://www.flexerasoftware.com/company/terms_of_use.htm" target="_blank"><span id="ids_terms">Terms of Use</span></a>  | <a id="Aprivacy" href="http://www.flexerasoftware.com/company/legal.htm" target="_blank"><span id="ids_privacy">Privacy Statement</span></a></div></td>
	<td width="18"><a href="" target="_blank"><img src="images/icon_help.gif" width="14" height="14" border="0" align="left"></a></td>
	<td><a href="help.htm" target="_blank"><span id="ids_help">Help</span></a></td>
	</tr>
	</table>
</div>
</body>
<script language="JavaScript">
function pageload()
{
	loadStrings();

	var saHidden = VBArray(window.parent.USUM.GetHiddenProducts()).toArray();
	var products = window.parent.Agent.EnumProducts(0);
	var i,j;
	for (i = 1; i < products.Count; i++)
	{
		var product = products.Item(i);
		if (product.UpdateAble == true)
		{
			var found = false;
			for (j = 0; j < saHidden.length; j++)
			{
				if (product.ProductCode.indexOf(saHidden[j]) != -1)
					found = true;
			}
			if (found == false)
			{
				var oOption = document.createElement("OPTION");
				selectproduct.options.add(oOption);
				oOption.innerText = product.Name;
				oOption.value = product.ProductCode;
			}
		}
	}
}

function docheck()
{
	var checkall = (selectproduct.options[selectproduct.selectedIndex].value.indexOf("_All") != -1);

//	window.parent.USUM.AutoCheck = checkauto.checked;
//	if (checkauto.checked == true)
//	{
//		if (checkall == true)
//			window.parent.USUM.RemoveProductForAutoCheck("");
//		else
//			window.parent.USUM.AddProductForAutoCheck(selectproduct.options[selectproduct.selectedIndex].value);
//	}

	if (checkall == true)
	{
		var i;
		for (i = 1; i < selectproduct.options.length; i++)
		{
			window.parent._ProductsGUID[i-1] = selectproduct.options[i].value;
			window.parent._ProductsName[i-1] = selectproduct.options[i].text;
		}
	}
	else
	{
		window.parent._ProductsGUID[0] = selectproduct.options[selectproduct.selectedIndex].value;
		window.parent._ProductsName[0] = selectproduct.options[selectproduct.selectedIndex].text;
	}

	window.parent.CheckForUpdates();
}

function loadStrings()
{
	document.charset = window.parent._UIcharset;

	if (_CustomStrings.length > 0)
		document.getElementById("strings").src = _CustomStrings + "/strings" + window.parent._UILangID + ".js";
	else
		document.getElementById("strings").src = "lang/strings" + window.parent._UILangID + ".js";
	if (typeof(ar) == "undefined")
		document.getElementById("strings").src = "lang/strings" + ((window.parent._UILangID & 0xff) + 1024) + ".js";
	if (typeof(ar) == "undefined")
		document.getElementById("strings").src = "lang/strings1033.js";

	document.getElementById("ids_settings").innerText = ar[IDS_SETTINGS];
	document.getElementById("ids_about").innerText = ar[IDS_ABOUT];
	document.getElementById("ids_new_updates").innerText = ar[IDS_NEW_UPDATES];
	document.getElementById("ids_click_msg").innerText = ar[IDS_CLICK_MSG];
	document.getElementById("ids_programs").innerText = ar[IDS_PROGRAMS];
	document.getElementById("selectproduct").options[0].innerText = ar[IDS_ALL];
	document.getElementById("checkbtn").value = ar[IDS_CHECK_4_UPDATES];
	document.getElementById("ids_copyright").innerText = ar[IDS_COPYRIGHT];
	document.getElementById("ids_terms").innerText = ar[IDS_TERMS];
	document.getElementById("ids_privacy").innerText = ar[IDS_PRIVACY];
	document.getElementById("ids_help").innerText = ar[IDS_HELP];
}
</script>
<script id="stringtable">
</script>
</html>
